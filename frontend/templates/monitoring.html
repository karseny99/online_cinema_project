<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        h1 {
            margin-bottom: 20px;
        }
        table {
            margin-top: 20px;
            border-collapse: collapse;
            width: 50%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        iframe {
            border: none;
            width: 100%;
            height: 80vh; /* –í—ã—Å–æ—Ç–∞ iframe */
        }
    </style>
</head>
<body>
    <h1>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤</h1>
    
    <table>
        <thead>
            <tr>
                <th>–°–µ—Ä–≤–∏—Å</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
            </tr>
        </thead>
        <tbody id="statusTable">
            <tr>
                <td>PostgreSQL</td>
                <td id="pgStatus">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
            </tr>
            <tr>
                <td>MinIO</td>
                <td id="minioStatus">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
            </tr>
        </tbody>
    </table>

    <iframe src="http://localhost:5555"></iframe>

    <script>
        async function checkService(serviceType) {
            const response = await fetch(`api/ping?service_type=${serviceType}`);
            return response.json();
        }
    
        async function updateStatus() {
            const pgPromise = checkService('pg').then(pgResponse => {
                document.getElementById('pgStatus').innerText = pgResponse.success ? 'Onlineüü¢' : 'Offlineüî¥';
            });
    
            const minioPromise = checkService('minio').then(minioResponse => {
                document.getElementById('minioStatus').innerText = minioResponse.success ? 'Onlineüü¢' : 'Offlineüî¥';
            });
    
            // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–º–∏—Å–æ–≤, –Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ –º–µ—Ä–µ –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            await Promise.all([pgPromise, minioPromise]);
        }
    
        // –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = updateStatus;
    </script>
    </body>
</html>
